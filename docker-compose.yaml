version: '2'
services:
  rabbitmq:
    environment:
      RABBITMQ_NODENAME: "rabbit"
      RABBITMQ_DEFAULT_USER: "guest"
      RABBITMQ_DEFAULT_PASS: "guest"
    image: rabbitmq:3.7.8-management
	container_name: wayne_rabbitmq
    networks:
    - default
    ports:
    - "5672:5672"
  mysql:
    image: mysql:5.6.41
    container_name: wayne_mysql
    environment:
      MYSQL_ROOT_PASSWORD: "root"
      MYSQL_DATABASE: wayne
      MYSQL_USER: wayne
      MYSQL_PASSWORD: wayne
    volumes:
      - ./_dev/mysql:/var/lib/mysql:z
    networks:
      - default
    expose:
      - "3306"
    ports:
      - "3306:3306"
  wayne:
    image: 360cloud/wayne:latest
    container_name: wayne_app
    command: /opt/wayne/backend apiserver
    environment:
      GOPATH: "/go"
    volumes:
      - ./src/backend/conf:/opt/wayne/conf:z
    networks:
      - default
    expose:
      - "8080"
    ports:
      - "8080:8080"
    links:
      - mysql
